# –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –µ–¥–∏–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

### ‚úÖ –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS –∏ Android
–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **Telegram WebApp**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **iOS** —á–µ—Ä–µ–∑ Telegram –¥–ª—è iOS
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **Android** —á–µ—Ä–µ–∑ Telegram –¥–ª—è Android  
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **Desktop** —á–µ—Ä–µ–∑ Telegram Desktop
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ **Web** —á–µ—Ä–µ–∑ –≤–µ–±-–≤–µ—Ä—Å–∏—é Telegram

### üîê –ï–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: `telegram_id` –∏–∑ `window.Telegram.WebApp.initDataUnsafe.user.id`
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Supabase —Å `telegram_id` –∫–∞–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ü—Ä–æ—Ñ–∏–ª—å, —Å–æ–±—ã—Ç–∏—è, –¥—Ä—É–∑—å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ–¥–Ω—É –ë–î

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ Telegram-–∞–∫–∫–∞—É–Ω—Ç = –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö ‚úÖ

---

## –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –¢–µ–∫—É—â–∏–π (Telegram WebApp) - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ï–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω (Telegram ID)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö —á–µ—Ä–µ–∑ Telegram
- –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram-—Ñ—É–Ω–∫—Ü–∏—è–º–∏ (–±–æ—Ç—ã, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram –∫–ª–∏–µ–Ω—Ç–∞
- –ù–µ—Ç standalone –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ App Store/Google Play

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ï—Å–ª–∏ –≤–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–∏ Telegram ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å.

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: PWA (Progressive Web App)
**–°—Ç–∞—Ç—É—Å**: –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–æ –∫ —Ç–µ–∫—É—â–µ–º—É —Ä–µ—à–µ–Ω–∏—é

**–ß—Ç–æ —ç—Ç–æ**: –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π —ç–∫—Ä–∞–Ω –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω–æ–µ

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ standalone –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏–∫–æ–Ω–∫–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ)
- –í—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ï–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ Telegram ID
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```json
// manifest.json –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å
{
  "name": "Linger",
  "short_name": "Linger",
  "start_url": "/",
  "display": "standalone",
  "theme_color": "#000000",
  "background_color": "#000000",
  "icons": [...]
}
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (React Native / Capacitor)
**–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏/–ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –î–æ—Å—Ç—É–ø–Ω–æ –≤ App Store –∏ Google Play
- –ù–∞—Ç–∏–≤–Ω—ã–π UX –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Firebase/APNs

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**:
- –ù—É–∂–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Telegram OAuth –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è)
- –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –∫–æ–¥–∞ (React Native –∏–ª–∏ Capacitor)
- –ë–æ–ª—å—à–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞**:

#### 3.1. Telegram OAuth (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Telegram Login Widget –∏–ª–∏ Bot API
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Telegram, –ø–æ–ª—É—á–∞–µ—Ç telegram_id
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ telegram_id –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å WebApp
```

#### 3.2. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
```typescript
// Email/Phone + –ø–∞—Ä–æ–ª—å
// –ù–û: –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã (Telegram ID <-> Email/Phone)
// –î–ª—è –µ–¥–∏–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –µ–¥–∏–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ telegram_id
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Supabase –µ—Å—Ç—å constraint:
```sql
ALTER TABLE profiles 
ADD CONSTRAINT profiles_telegram_id_unique 
UNIQUE (telegram_id);
```

### 2. –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—Ö–æ–¥–µ:
```typescript
// src/lib/auth.ts
export const syncUserProfile = async (telegramUser: TelegramWebAppUser) => {
  const { data, error } = await supabase
    .from('profiles')
    .upsert({
      id: telegramUser.id, // telegram_id –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ id
      telegram_id: telegramUser.id,
      full_name: telegramUser.first_name || telegramUser.username,
      avatar_url: telegramUser.photo_url,
      last_seen: new Date().toISOString(),
    }, {
      onConflict: 'telegram_id'
    });
  
  return { data, error };
};
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Telegram
const isAuthenticated = () => {
  return !!window.Telegram?.WebApp?.initDataUnsafe?.user?.id;
};
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–º–µ–Ω—ã –∞–∫–∫–∞—É–Ω—Ç–∞
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–µ–Ω–∏–ª –∞–∫–∫–∞—É–Ω—Ç Telegram –≤ –∫–ª–∏–µ–Ω—Ç–µ:
```typescript
useEffect(() => {
  const handleThemeChange = () => {
    // –ü—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã Telegram –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const newUserId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id;
    if (newUserId && newUserId !== currentUserId) {
      // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      loadUserProfile(newUserId);
    }
  };
  
  window.Telegram?.WebApp?.onEvent('themeChanged', handleThemeChange);
}, []);
```

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –î–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):
‚úÖ **–û—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é** ‚Äî –æ–Ω–∞ —É–∂–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –†–∞–±–æ—Ç—É –Ω–∞ iOS/Android —á–µ—Ä–µ–∑ Telegram
- –ï–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ Telegram ID
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Supabase

### –ï—Å–ª–∏ –Ω—É–∂–µ–Ω standalone:
üîÑ **–î–æ–±–∞–≤—å—Ç–µ PWA** (–º–∏–Ω–∏–º—É–º –∏–∑–º–µ–Ω–µ–Ω–∏–π) –∏–ª–∏ **React Native/Capacitor** (–±–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã, –Ω–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)

---

## –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è

1. **–ù—É–∂–Ω–æ –ª–∏ standalone –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?** (–≤–Ω–µ Telegram –∫–ª–∏–µ–Ω—Ç–∞)
   - –ù–µ—Ç ‚Üí –û—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å ‚úÖ
   - –î–∞ ‚Üí –í–∞—Ä–∏–∞–Ω—Ç 2 (PWA) –∏–ª–∏ 3 (Native)

2. **–ù—É–∂–Ω–∞ –ª–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ App Store/Google Play?**
   - –ù–µ—Ç ‚Üí PWA –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
   - –î–∞ ‚Üí React Native/Capacitor

3. **–ù—É–∂–Ω–∞ –ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–µ–∑ Telegram?**
   - –ù–µ—Ç ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram OAuth
   - –î–∞ ‚Üí –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–Ω–æ —Å–ª–æ–∂–Ω–µ–µ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS –∏ Android —Å –µ–¥–∏–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º!** üéâ

Telegram WebApp –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å
- –ï–¥–∏–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ Telegram ID
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (standalone, –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö), –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å PWA –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å Telegram OAuth –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.
